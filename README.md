# Web-версия книжного магазина

Функционал:
- Пользователь: просмотр каталога, фильтр/сортировка по категории/автору/году, покупка или аренда (2 недели / 1 месяц / 3 месяца).
- Администратор: добавление/изменение/удаление книг, управление ценой и статусом (available/unavailable/sold), просмотр аренд/покупок, напоминания об истечении аренды.
- Напоминания: фоновая проверка раз в минуту — помечает просроченные аренды, для аренд с истечением <24ч пишет уведомление в консоль; отдельный эндпоинт отдаёт аренды с истечением в ближайшие 3 дня.
- База: SQLite (`data.sqlite`) с таблицами `books` и `rentals`. При пустой БД автосидинг любимых книг.

## Запуск
```
cd bookshop
npm install
npm start
```
Откройте в браузере `http://localhost:4000/`.

Параметры:
- Порт: `PORT` (по умолчанию 4000)
- Ключ админа: `ADMIN_KEY` (по умолчанию `admin123`, передаётся в заголовке `x-admin-key`)

## API (кратко)
- `GET /api/books?category=&author=&year=&sort=` — каталог, фильтры и сортировки.
- `GET /api/books/:id` — книга.
- `POST /api/rent {bookId, userName, mode: purchase|rent, duration: 2w|1m|3m}` — покупка/аренда. Для покупки duration не требуется.

Админ (заголовок `x-admin-key`):
- `POST /api/admin/books` — добавить книгу.
- `PUT /api/admin/books/:id` — обновить.
- `DELETE /api/admin/books/:id` — удалить (+чистит аренды книги).
- `GET /api/admin/rentals` — список аренд/покупок.
- `GET /api/admin/reminders` — аренды, истекающие в ближайшие 3 дня.

## Анализ выполнения (7+ пунктов)
1. Архитектура: Express + SQLite, таблицы `books` и `rentals`, статический фронт на fetch; без сложной аутентификации, админ защищён ключом.
2. Каталог: фильтры по категории/автору/году, сортировки по автору/категории/году; отображение статуса и цены.
3. Покупка/аренда: покупки сразу помечают книгу как sold; аренды сохраняют срок (14/30/90 дней), статус `active`.
4. Сроки и статусы: фон-джоб раз в минуту помечает просроченные аренды, формирует напоминания (<24ч) и отмечает отправку; отдельный эндпоинт для ближайших 3 дней.
5. Админ: CRUD по книгам, обновление цены/статуса, удаление книг с каскадным удалением аренд, просмотр всех аренд.
6. Данные: автосоздание схемы и сидинг любимых книг при первом запуске; файл БД в корне, в `.gitignore`.
7. UI: две зоны — пользователь (каталог, фильтр, покупка/аренда) и админ (ключ, добавление, правка, аренды, напоминания); всплывающие уведомления о статусе операций.
8. Наблюдаемость: базовый health `/api/health`, логирование напоминаний в консоль.

## Рекомендации по улучшению
- Ввести полноценную аутентификацию пользователей и админов (JWT), учёт баланса/платежей.
- Добавить пагинацию и поиск по подстроке.
- Ввести email/SMS рассылку напоминаний вместо логов, хранить контакт пользователя.
- Валидировать поля (длины, диапазоны, цена > 0), централизованный обработчик ошибок.
- Добавить тесты (unit + интеграционные), линтер/форматтер.
- Сделать миграции схемы (например, knex/migrate), резервное копирование `data.sqlite`.
- На фронте — вынести в React/Vite при необходимости большего UX, добавить спиннеры/состояния загрузки.
- Перевести статусы книг и аренд в enum-значения и UI-переключатели, добавить фильтры по статусу в каталоге.

## GitHub
Инициализация (пример):
```
git init
git add .
git commit -m "Bookshop app"
git branch -M main
git remote add origin https://github.com/yanushkayy/bookstore-web.git
git push -u origin main
```

